---
import MainLayout from '../layouts/MainLayout.astro';
---

<MainLayout title="Kontakt - Logopädie 21">
  <div class="bg-brand-purple min-h-screen py-12">
    <div class="container mx-auto px-4">
      <!-- Map Section -->
      <div class="bg-white rounded-lg shadow-lg overflow-hidden mb-8">
        <iframe 
          src="https://maps.google.com/maps?q=bollwerk21,%203011%20Bern&t=&z=15&ie=UTF8&iwloc=&output=embed" 
          class="w-full h-[400px]" 
          style="border:0;" 
          allowfullscreen="" 
          loading="lazy"
        ></iframe>
      </div>
      
      <div class="grid grid-cols-1 lg:grid-cols-2 gap-8">
        <!-- Contact Information Section -->
        <div class="bg-white rounded-lg shadow-lg p-8">
          <h2 class="text-2xl font-bold mb-4">Kontakt</h2>
          <p class="mb-8">
            Logopädie 21<br>
            Bollwerk 21<br>
            3011 Bern<br>
            <a href="mailto:info@logopaedie21.ch" class="text-primary hover:underline">info@logopaedie21.ch</a> • 
            <a href="tel:+41313717200" class="text-primary hover:underline">031 371 72 00</a>
          </p>
          
          <h2 class="text-2xl font-bold mb-4">KONTAKT DIREKT</h2>
          
          <div class="space-y-4">
            <div>
              <p class="font-bold">Jolanda Baumann</p>
              <p>
                <a href="mailto:logopaedie@bluemail.ch" class="text-primary hover:underline">logopaedie@bluemail.ch</a> • 
                <a href="tel:+41766851889" class="text-primary hover:underline">076 685 18 89</a>
              </p>
            </div>
            
            <div>
              <p class="font-bold">Franziska Bodenmann</p>
              <p>
                <a href="mailto:franziska.bodenmann@hin.ch" class="text-primary hover:underline">franziska.bodenmann@hin.ch</a> • 
                <a href="tel:+41782101966" class="text-primary hover:underline">078 210 19 66</a>
              </p>
            </div>
            
            <div>
              <p class="font-bold">Almut Steiger</p>
              <p>
                <a href="mailto:almut.steiger@hin.ch" class="text-primary hover:underline">almut.steiger@hin.ch</a> • 
                <a href="tel:+41763220315" class="text-primary hover:underline">076 322 03 15</a>
              </p>
            </div>
            
            <div>
              <p class="font-bold">Livia Thürlemann</p>
              <p>
                <a href="mailto:logopaedie@bluemail.ch" class="text-primary hover:underline">logopaedie@bluemail.ch</a> • 
                <a href="tel:+41313717200" class="text-primary hover:underline">031 371 72 00</a>
              </p>
            </div>
            
            <div>
              <p class="font-bold">Barbara Walker</p>
              <p>
                <a href="mailto:logopaedie@bluemail.ch" class="text-primary hover:underline">logopaedie@bluemail.ch</a> • 
                <a href="tel:+41313717200" class="text-primary hover:underline">031 371 72 00</a>
              </p>
            </div>
          </div>
          
          <div class="mt-8">
            <img 
              src="/images/bollwerk21.jpg" 
              alt="Bollwerk 21" 
              class="w-full h-auto rounded-lg mb-6"
            >
          </div>
        </div>
        
        <!-- Contact Form Section with FormSubmit -->
        <div class="bg-white rounded-lg shadow-lg p-8">
          <h2 class="text-2xl font-bold mb-6">Kontaktformular</h2>
          
          <form 
            id="contact-form" 
            class="space-y-6"
          >
            <!-- FormSubmit configuration is now handled in JavaScript -->
            
            <div>
              <label for="name" class="block text-gray-700 mb-2">Name</label>
              <input 
                type="text" 
                id="name" 
                name="name" 
                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-30 outline-none transition"
                required
              />
            </div>
            
            <div>
              <label for="email" class="block text-gray-700 mb-2">E-Mail</label>
              <input 
                type="email" 
                id="email" 
                name="email" 
                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-30 outline-none transition"
                required
              />
            </div>
            
            <div>
              <label for="phone" class="block text-gray-700 mb-2">Telefon</label>
              <input 
                type="tel" 
                id="phone" 
                name="phone" 
                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-30 outline-none transition"
              />
            </div>
            
            <div>
              <label for="message" class="block text-gray-700 mb-2">Nachricht</label>
              <textarea 
                id="message" 
                name="message" 
                rows="5" 
                class="w-full px-4 py-3 rounded-lg border border-gray-300 focus:border-primary focus:ring-2 focus:ring-primary focus:ring-opacity-30 outline-none transition"
                required
              ></textarea>
            </div>
            
            <button 
              type="submit" 
              class="w-full bg-primary text-white font-bold py-3 px-6 rounded-lg hover:bg-primary/90 transition duration-300"
            >
              Nachricht senden
            </button>
          </form>
          
          <div id="form-success" class="hidden mt-6 p-4 bg-green-100 text-green-700 rounded-lg">
            Vielen Dank für Ihre Nachricht! Wir werden uns schnellstmöglich bei Ihnen melden.
          </div>
          
          <div id="form-error" class="hidden mt-6 p-4 bg-red-100 text-red-700 rounded-lg">
            Es ist ein Fehler aufgetreten. Bitte versuchen Sie es später erneut oder kontaktieren Sie uns direkt per Telefon oder E-Mail.
          </div>
        </div>
      </div>
    </div>
  </div>
</MainLayout>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const form = document.getElementById('contact-form') as HTMLFormElement;
    const successMessage = document.getElementById('form-success');
    const errorMessage = document.getElementById('form-error');
    
    if (form) {
      form.addEventListener('submit', async (e) => {
        e.preventDefault();
        
        // Hide any previous messages
        successMessage?.classList.add('hidden');
        errorMessage?.classList.add('hidden');
        
        // Show loading state
        const submitButton = form.querySelector('button[type="submit"]') as HTMLButtonElement;
        const originalButtonText = submitButton.textContent || 'Nachricht senden';
        submitButton.textContent = 'Wird gesendet...';
        submitButton.disabled = true;
        
        try {
          // Get form data
          const formData = new FormData(form);
          
          // Add FormSubmit configuration to formData
          formData.append('_subject', 'Neue Anfrage von Logopädie 21 Website');
          formData.append('_template', 'table');
          formData.append('_captcha', 'false');
          
          // Submit form using fetch
          const response = await fetch('https://formsubmit.co/maxsteiger98@gmail.com', {
            method: 'POST',
            body: formData,
            headers: {
              'Accept': 'application/json'
            }
          });
          
          // Check if successful
          if (response.ok) {
            // Show success message
            form.reset();
            successMessage?.classList.remove('hidden');
            
            // Scroll to the success message
            successMessage?.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
            
            // Hide success message after 5 seconds
            setTimeout(() => {
              successMessage?.classList.add('hidden');
            }, 5000);
          } else {
            // Show error message for HTTP errors
            errorMessage?.classList.remove('hidden');
          }
        } catch (error) {
          // Show error message for network/other errors
          console.error('Form submission error:', error);
          errorMessage?.classList.remove('hidden');
        } finally {
          // Reset button state
          submitButton.textContent = originalButtonText;
          submitButton.disabled = false;
        }
      });
    }
  });
</script>